<% content_for :title, "Our Generous Donors" %>

<!-- Breadcrumb Navigation -->
<nav aria-label="breadcrumb" class="mb-3">
  <ol class="breadcrumb">
    <li class="breadcrumb-item">
      <%= link_to "Home", root_path, class: "text-decoration-none" %>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Donors</li>
  </ol>
</nav>

<!-- Action Buttons -->
<div class="d-flex flex-wrap gap-2 mb-3">
  <%= link_to root_path, class: "btn btn-outline-secondary" do %>
    <i class="fas fa-arrow-left me-2"></i>Back to Home
  <% end %>
</div>

<!-- Header Card -->
<div class="card shadow-sm mb-4">
  <div class="card-header bg-primary text-white">
    <div class="d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center">
        <i class="fas fa-hand-holding-heart me-2"></i>
        <h1 class="h4 mb-0">Our Generous Donors</h1>
      </div>
      <div class="d-flex align-items-center">
        <span class="badge bg-light text-dark">
          <i class="fas fa-heart me-1"></i>
          <%= pluralize(@individual_donors.count + @business_donors.count, 'Supporter') %>
        </span>
      </div>
    </div>
  </div>
  <div class="card-body">
    <p class="text-muted mb-0">
      <i class="fas fa-info-circle me-1"></i>
      Thank you to all who support the Lake Elementary Pokémon Club and make our activities possible.
    </p>
  </div>
</div>

<!-- Thank You Message -->
<div class="alert alert-info mb-4" role="alert">
  <div class="d-flex align-items-start">
    <i class="fas fa-heart me-2 mt-1"></i>
    <div>
      <h6 class="alert-heading">Thank You!</h6>
      <p class="mb-0">
        The Lake Elementary Pokémon Club is made possible by the generous support of our community.
        Every contribution helps us provide engaging activities and resources for our students.
      </p>
    </div>
  </div>
</div>

<% if @business_donors.any? %>
  <!-- Business Donors Section -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h5 class="text-dark border-bottom pb-2 mb-4">
        <i class="fas fa-building me-2"></i>Business Sponsors
      </h5>

      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-light">
            <tr>
              <th scope="col">
                <i class="fas fa-image me-1"></i>Logo
              </th>
              <th scope="col">
                <i class="fas fa-building me-1"></i>Business Name
              </th>
              <th scope="col">
                <i class="fas fa-gift me-1"></i>Support Type
              </th>
              <th scope="col">
                <i class="fas fa-dollar-sign me-1"></i>Total Donated
              </th>
              <th scope="col">
                <i class="fas fa-link me-1"></i>Website
              </th>
            </tr>
          </thead>
          <tbody>
            <% @business_donors.each do |donor| %>
              <tr>
                <td class="text-center" style="width: 80px;">
                  <% if donor.has_logo_or_photo? %>
                    <%= image_tag donor.photo_or_logo,
                                  alt: "#{donor.display_name} logo",
                                  class: "img-thumbnail",
                                  style: "max-width: 60px; max-height: 60px; object-fit: contain;" %>
                  <% else %>
                    <div class="text-center p-2 bg-light rounded">
                      <i class="fas fa-building fa-2x text-muted"></i>
                    </div>
                  <% end %>
                </td>
                <td>
                  <div class="fw-medium text-dark"><%= donor.display_name %></div>
                </td>
                <td>
                  <span class="text-muted">
                    <i class="fas fa-gift me-1"></i>
                    <% if donor.donations.any? %>
                      <%= pluralize(donor.donation_count, 'donation') %>
                    <% else %>
                      General Support
                    <% end %>
                  </span>
                </td>
                <td>
                  <% unless donor.privacy_private? %>
                    <span class="text-success fw-medium">
                      <%= donor.formatted_total_donated %>
                    </span>
                  <% else %>
                    <span class="text-muted">
                      <i class="fas fa-eye-slash me-1"></i>Amount not disclosed
                    </span>
                  <% end %>
                </td>
                <td>
                  <% if donor.website_link.present? %>
                    <%= link_to donor.website_link, target: "_blank", rel: "noopener", class: "btn btn-sm btn-outline-primary" do %>
                      <i class="fas fa-external-link-alt me-1"></i>Visit
                    <% end %>
                  <% else %>
                    <span class="text-muted">—</span>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
<% end %>

<% if @individual_donors.any? %>
  <!-- Individual Donors Section -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h5 class="text-dark border-bottom pb-2 mb-4">
        <i class="fas fa-users me-2"></i>Individual Donors
      </h5>

      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-light">
            <tr>
              <th scope="col">
                <i class="fas fa-image me-1"></i>Photo
              </th>
              <th scope="col">
                <i class="fas fa-user me-1"></i>Donor Name
              </th>
              <th scope="col">
                <i class="fas fa-gift me-1"></i>Support Type
              </th>
              <th scope="col">
                <i class="fas fa-dollar-sign me-1"></i>Total Donated
              </th>
            </tr>
          </thead>
          <tbody>
            <% @individual_donors.each do |donor| %>
              <tr>
                <td class="text-center" style="width: 80px;">
                  <% if donor.has_logo_or_photo? %>
                    <%= image_tag donor.photo_or_logo,
                                  alt: "#{donor.display_name}",
                                  class: "rounded-circle img-thumbnail",
                                  style: "width: 60px; height: 60px; object-fit: cover;" %>
                  <% else %>
                    <div class="text-center">
                      <i class="fas fa-user-circle fa-3x text-muted"></i>
                    </div>
                  <% end %>
                </td>
                <td>
                  <div class="fw-medium text-dark"><%= donor.display_name %></div>
                </td>
                <td>
                  <span class="text-muted">
                    <i class="fas fa-gift me-1"></i>
                    <% if donor.donations.any? %>
                      <%= pluralize(donor.donation_count, 'donation') %>
                    <% else %>
                      General Support
                    <% end %>
                  </span>
                </td>
                <td>
                  <% unless donor.privacy_private? %>
                    <span class="text-success fw-medium">
                      <%= donor.formatted_total_donated %>
                    </span>
                  <% else %>
                    <span class="text-muted">
                      <i class="fas fa-eye-slash me-1"></i>Amount not disclosed
                    </span>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
<% end %>

<% if @individual_donors.empty? && @business_donors.empty? %>
  <!-- Empty State -->
  <div class="card shadow-sm">
    <div class="card-body text-center py-5">
      <i class="fas fa-hand-holding-heart fa-3x text-muted mb-3"></i>
      <h5 class="text-muted">Donor Wall Coming Soon</h5>
      <p class="text-muted">
        We're grateful for all support of the Lake Elementary Pokémon Club.
        Donor recognition will be displayed here as contributions are received.
      </p>
    </div>
  </div>
<% end %>