<% content_for :title, "Home" %>

<!-- Hero Section -->
<div class="card shadow-sm mb-4" style="background: linear-gradient(135deg, var(--pokemon-electric-blue) 0%, #0066CC 100%);">
  <div class="card-body py-5">
    <div class="row align-items-center">
      <div class="col-lg-8">
        <h1 class="display-4 fw-bold text-white mb-3">
          Lake Elementary <br> Pokémon Club
        </h1>
        <p class="lead text-white mb-4">
          Our mission is to provide a safe and inclusive space for Lake Elementary students in Vista
          to connect through the wonderful world of Pokémon. Join our after-school community of young trainers!
        </p>
        <div class="d-flex flex-wrap gap-3">
          <%= link_to events_path, class: "btn btn-light btn-lg" do %>
            <i class="fas fa-calendar-alt me-2"></i>View Events
          <% end %>
          <%= link_to students_path, class: "btn btn-outline-light btn-lg" do %>
            <i class="fas fa-users me-2"></i>Meet Our Members
          <% end %>
        </div>
      </div>
      <div class="col-lg-4 text-center mt-4 mt-lg-0">
        <div class="d-inline-block">
          <%= image_tag "pokemon-club-logo_448x448.png",
                        alt: "Lake Elementary Pokémon Club Logo",
                        class: "img-fluid rounded-circle shadow-sm",
                        style: "width: 180px; height: 180px; object-fit: cover;" %>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Mission Statement -->
<div class="card shadow-sm mb-4">
  <div class="card-body text-center py-4" style="background-color: var(--pokemon-light-yellow);">
    <h3 class="text-dark mb-3">
      <i class="fas fa-shield-alt me-2 text-warning"></i>
      Our Mission
    </h3>
    <p class="lead text-dark mb-3">
      To provide a safe and inclusive environment where Lake Elementary students in Vista can
      build friendships, develop social skills, and explore their passion for Pokémon.
    </p>
    <div class="row g-3 text-center mt-4">
      <div class="col-md-4">
        <i class="fas fa-users fa-2x text-dark mb-2"></i>
        <h6 class="text-dark">Community Building</h6>
        <small class="text-muted">Connecting students through shared interests</small>
      </div>
      <div class="col-md-4">
        <i class="fas fa-handshake fa-2x text-dark mb-2"></i>
        <h6 class="text-dark">Inclusive Environment</h6>
        <small class="text-muted">Welcoming all trainers regardless of skill level</small>
      </div>
      <div class="col-md-4">
        <i class="fas fa-graduation-cap fa-2x text-dark mb-2"></i>
        <h6 class="text-dark">Learning & Fun</h6>
        <small class="text-muted">Educational activities wrapped in entertainment</small>
      </div>
    </div>
  </div>
</div>

<!-- Donor Carousel Section -->
<% if @business_donors&.any? || @individual_donors&.any? %>
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-warning text-dark">
      <div class="d-flex align-items-center">
        <i class="fas fa-heart me-2"></i>
        <h3 class="h5 mb-0">Thank You to Our Amazing Supporters!</h3>
      </div>
    </div>
    <div class="card-body">
      <style>
        /* Donor carousel specific styles */
        #donorCarousel .carousel-item {
          transition: transform 0.6s ease-in-out;
        }

        #donorCarousel .donor-card {
          transition: transform 0.2s ease-in-out;
          border-radius: 8px;
        }

        #donorCarousel .donor-card:hover {
          transform: translateY(-2px);
          background-color: rgba(255, 215, 0, 0.1);
        }

        #donorCarousel .donor-image-container img {
          transition: transform 0.2s ease-in-out;
        }

        #donorCarousel .donor-card:hover .donor-image-container img {
          transform: scale(1.05);
        }

        /* Ensure consistent carousel height */
        #donorCarousel .carousel-inner {
          min-height: 180px;
        }

        #donorCarousel .carousel-item {
          min-height: 180px;
          padding: 20px 0;
        }

        /* Custom carousel controls for better visibility */
        #donorCarousel .carousel-control-prev,
        #donorCarousel .carousel-control-next {
          width: 5%;
          opacity: 0.7;
        }

        #donorCarousel .carousel-control-prev:hover,
        #donorCarousel .carousel-control-next:hover {
          opacity: 1;
        }

        /* Custom carousel indicators */
        #donorCarousel .carousel-indicators {
          margin-bottom: -25px;
        }

        #donorCarousel .carousel-indicators button {
          background-color: var(--pokemon-electric-blue);
          opacity: 0.5;
          width: 10px;
          height: 10px;
          border-radius: 50%;
          margin: 0 3px;
        }

        #donorCarousel .carousel-indicators button.active {
          opacity: 1;
          background-color: #FFD700;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          #donorCarousel .carousel-inner {
            min-height: 160px;
          }

          #donorCarousel .donor-text-container {
            min-height: 50px !important;
          }
        }
      </style>
      <p class="text-muted mb-4">
        <i class="fas fa-info-circle me-1"></i>
        The Lake Elementary Pokémon Club is made possible by these generous community supporters.
      </p>

      <!-- Donor Carousel -->
      <div id="donorCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
        <div class="carousel-inner" style="min-height: 180px;">
          <% all_donors = (@business_donors || []) + (@individual_donors || []) %>
          <% all_donors.each_slice(3).each_with_index do |donor_group, index| %>
            <div class="carousel-item <%= 'active' if index == 0 %>">
              <div class="row g-3 justify-content-center">
                <% donor_group.each do |donor| %>
                  <div class="col-md-4 text-center">
                    <div class="donor-card p-3">
                      <!-- Fixed height image/icon container -->
                      <div class="donor-image-container mb-3" style="height: 80px; display: flex; align-items: center; justify-content: center;">
                        <% if donor.has_logo_or_photo? %>
                          <%= image_tag donor.photo_or_logo,
                                        alt: "#{donor.display_name}",
                                        class: donor.donor_type == 'business' ? 'img-thumbnail' : 'rounded-circle img-thumbnail',
                                        style: "max-width: 80px; max-height: 80px; object-fit: #{ donor.donor_type == 'business' ? 'contain' : 'cover' };" %>
                        <% else %>
                          <% if donor.donor_type == 'business' %>
                            <i class="fas fa-building fa-3x text-muted"></i>
                          <% else %>
                            <i class="fas fa-user-circle fa-3x text-muted"></i>
                          <% end %>
                        <% end %>
                      </div>

                      <!-- Fixed height text container -->
                      <div class="donor-text-container text-center" style="min-height: 60px;">
                        <div class="fw-medium text-dark small mb-1" style="line-height: 1.3;">
                          <%= truncate(donor.display_name, length: 24) %>
                        </div>
                        <% if donor.donor_type == 'business' %>
                          <small class="text-muted d-block">Business Sponsor</small>
                        <% else %>
                          <small class="text-muted d-block">Individual Donor</small>
                        <% end %>
                      </div>
                    </div>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>

        <!-- Carousel Indicators -->
        <% if all_donors.count > 3 %>
          <div class="carousel-indicators">
            <% all_donors.each_slice(3).each_with_index do |_, index| %>
              <button type="button"
                      data-bs-target="#donorCarousel"
                      data-bs-slide-to="<%= index %>"
                      class="<%= 'active' if index == 0 %>"
                      aria-current="<%= 'true' if index == 0 %>"
                      aria-label="Slide <%= index + 1 %>"></button>
            <% end %>
          </div>
        <% end %>

        <!-- Carousel Controls -->
        <% if all_donors.count > 3 %>
          <button class="carousel-control-prev" type="button" data-bs-target="#donorCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#donorCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        <% end %>
      </div>

      <div class="text-center mt-4">
        <%= link_to public_donors_path, class: "btn btn-outline-warning" do %>
          <i class="fas fa-heart me-2"></i>View All Our Supporters
        <% end %>
      </div>
    </div>
  </div>
<% end %>

<!-- Information and Next Event Cards -->
<div class="row g-4 mb-4">
  <!-- Club Bylaws Card -->
  <div class="col-md-4">
    <div class="card shadow-sm h-100">
      <div class="card-header bg-warning text-dark">
        <div class="d-flex align-items-center">
          <i class="fas fa-gavel me-2"></i>
          <h4 class="h5 mb-0">Club Bylaws</h4>
        </div>
      </div>
      <div class="card-body d-flex flex-column">
        <p class="text-dark mb-3">
          <i class="fas fa-shield-alt me-1 text-warning"></i>
          Review our official club rules, guidelines, and expectations for all members and families.
        </p>
        <p class="text-muted mb-4">
          Learn about safety policies, behavior expectations, card trading rules, and how we create
          an inclusive environment for all Pokémon trainers in grades K-5.
        </p>
        <div class="mt-auto">
          <%= link_to bylaws_path, class: "btn btn-warning" do %>
            <i class="fas fa-book me-2"></i>Read Club Bylaws
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Volunteer Card -->
  <div class="col-md-4">
    <div class="card shadow-sm h-100">
      <div class="card-header bg-success text-white">
        <div class="d-flex align-items-center">
          <i class="fas fa-hands-helping me-2"></i>
          <h4 class="h5 mb-0">Volunteers Needed</h4>
        </div>
      </div>
      <div class="card-body d-flex flex-column">
        <p class="text-dark mb-3">
          <i class="fas fa-heart me-1 text-success"></i>
          The Lake Elementary Pokémon Club is always looking for enthusiastic volunteers to help make our activities even more amazing!
        </p>
        <p class="text-muted mb-4">
          Whether you're helping with events, supervising activities, or sharing your Pokémon expertise,
          every bit of help makes a difference in our students' experience.
        </p>
        <div class="mt-auto">
          <a href="mailto:contact@lakepokemonclub.org" class="btn btn-success">
            <i class="fas fa-envelope me-2"></i>Contact Us to Volunteer
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Next Event Card -->
  <div class="col-md-4">
    <div class="card shadow-sm h-100">
      <div class="card-header bg-primary text-white">
        <div class="d-flex align-items-center">
          <i class="fas fa-calendar-alt me-2"></i>
          <h4 class="h5 mb-0">Next Event</h4>
        </div>
      </div>
      <div class="card-body d-flex flex-column">
        <% if @next_event %>
          <h5 class="text-dark mb-3">
            <i class="fas fa-star me-1 text-warning"></i>
            <%= @next_event.title %>
          </h5>
          <div class="mb-3">
            <div class="text-muted small mb-1">
              <i class="fas fa-calendar me-1"></i>Date & Time
            </div>
            <div class="fw-medium text-dark">
              <%= @next_event.starts_at.in_time_zone(@next_event.time_zone).strftime("%A, %B %d, %Y") %>
            </div>
            <div class="text-dark">
              <%= @next_event.starts_at.in_time_zone(@next_event.time_zone).strftime("%l:%M %p") %> -
              <%= @next_event.ends_at.in_time_zone(@next_event.time_zone).strftime("%l:%M %p") %>
              <small class="text-muted">(<%= @next_event.time_zone %>)</small>
            </div>
          </div>

          <% if @next_event.venue.present? %>
            <div class="mb-3">
              <div class="text-muted small mb-1">
                <i class="fas fa-map-marker-alt me-1"></i>Location
              </div>
              <div class="text-dark"><%= @next_event.venue %></div>
            </div>
          <% end %>

          <% if @next_event.description.present? %>
            <div class="mb-3">
              <div class="text-muted small mb-1">
                <i class="fas fa-info-circle me-1"></i>Description
              </div>
              <div class="text-dark"><%= truncate(@next_event.description, length: 120) %></div>
            </div>
          <% end %>

          <div class="mt-auto">
            <%= link_to events_path, class: "btn btn-primary" do %>
              <i class="fas fa-arrow-right me-2"></i>View All Events
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-4">
            <i class="fas fa-calendar-plus fa-3x text-muted mb-3"></i>
            <h5 class="text-muted mb-2">More Events Coming Soon!</h5>
            <p class="text-muted mb-4">
              We're planning exciting new Pokémon adventures. Keep checking this page for updates!
            </p>
            <div class="mt-auto">
              <%= link_to events_path, class: "btn btn-outline-primary" do %>
                <i class="fas fa-calendar me-2"></i>Check Events Page
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
