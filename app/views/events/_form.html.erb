<%= form_with(model: event, local: true, class: "needs-validation", novalidate: true) do |form| %>
  <div class="row">
    <div class="col-12">
      <% if event.errors.any? %>
        <div class="alert alert-danger mb-4">
          <h5 class="alert-heading">
            <i class="bi bi-exclamation-triangle me-2"></i>
            <%= pluralize(event.errors.count, "error") %> prohibited this event from being saved:
          </h5>
          <ul class="mb-0">
            <% event.errors.each do |error| %>
              <li><%= error.full_message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Basic Event Information -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-header" style="background-color: #f8f9fa;">
      <h5 class="mb-0">
        <i class="bi bi-info-circle me-2" style="color: #0084FF;"></i>
        Basic Information
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <!-- Title -->
        <div class="col-12">
          <%= form.label :title, class: "form-label fw-bold" do %>
            Event Title <span class="text-danger">*</span>
          <% end %>
          <%= form.text_field :title, class: "form-control", placeholder: "e.g., Pokemon Club Meeting", required: true %>
          <div class="invalid-feedback">Please provide a valid event title.</div>
        </div>

        <!-- Description -->
        <div class="col-12">
          <%= form.label :description, class: "form-label fw-bold" %>
          <%= form.text_area :description, class: "form-control", rows: 4,
              placeholder: "Describe what will happen at this event..." %>
          <div class="form-text">Provide details about the event activities, agenda, or special instructions.</div>
        </div>

        <!-- Status and Special Event -->
        <div class="col-12 col-md-6">
          <%= form.label :status, class: "form-label fw-bold" do %>
            Status <span class="text-danger">*</span>
          <% end %>
          <%= form.select :status,
              options_for_select([
                ['Draft', 'draft'],
                ['Published', 'published'],
                ['Cancelled', 'canceled']
              ], event.status),
              { prompt: 'Select status...' },
              { class: "form-select", required: true } %>
          <div class="form-text">Draft events are only visible to admins.</div>
        </div>

        <div class="col-12 col-md-6 d-flex align-items-end">
          <div class="form-check form-switch">
            <%= form.check_box :special, class: "form-check-input", style: "transform: scale(1.2);" %>
            <%= form.label :special, class: "form-check-label fw-bold ms-2" do %>
              <i class="bi bi-star me-1" style="color: #FFD700;"></i>
              Special Event
            <% end %>
            <div class="form-text mt-1">Mark this as a special event (not a regular meeting)</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Date & Time -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-header" style="background-color: #f8f9fa;">
      <h5 class="mb-0">
        <i class="bi bi-calendar3 me-2" style="color: #0084FF;"></i>
        Date & Time
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <!-- Start Date/Time -->
        <div class="col-12 col-md-6">
          <%= form.label :starts_at, class: "form-label fw-bold" do %>
            Start Date & Time <span class="text-danger">*</span>
          <% end %>
          <%= form.datetime_local_field :starts_at, class: "form-control", required: true %>
        </div>

        <!-- End Date/Time -->
        <div class="col-12 col-md-6">
          <%= form.label :ends_at, class: "form-label fw-bold" do %>
            End Date & Time <span class="text-danger">*</span>
          <% end %>
          <%= form.datetime_local_field :ends_at, class: "form-control", required: true %>
        </div>

        <!-- Time Zone -->
        <div class="col-12">
          <%= form.label :time_zone, class: "form-label fw-bold" %>
          <%= form.select :time_zone,
              options_for_select([
                ['Pacific Time - Los Angeles', 'America/Los_Angeles'],
                ['Mountain Time - Denver', 'America/Denver'],
                ['Central Time - Chicago', 'America/Chicago'],
                ['Eastern Time - New York', 'America/New_York']
              ], event.time_zone || 'America/Los_Angeles'),
              {},
              { class: "form-select" } %>
          <div class="form-text">Select the timezone for this event.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Location Information -->
  <div class="card border-0 shadow-sm mb-4">
    <div class="card-header" style="background-color: #f8f9fa;">
      <h5 class="mb-0">
        <i class="bi bi-geo-alt me-2" style="color: #0084FF;"></i>
        Location <span class="text-muted">(Optional)</span>
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <!-- Venue Name -->
        <div class="col-12">
          <%= form.label :venue, class: "form-label fw-bold" %>
          <%= form.text_field :venue, class: "form-control",
              placeholder: "e.g., Lake Elementary School Library" %>
        </div>

        <!-- Address -->
        <div class="col-12">
          <%= form.label :address1, "Address Line 1", class: "form-label fw-bold" %>
          <%= form.text_field :address1, class: "form-control",
              placeholder: "Street address" %>
        </div>

        <div class="col-12">
          <%= form.label :address2, "Address Line 2", class: "form-label fw-bold" %>
          <%= form.text_field :address2, class: "form-control",
              placeholder: "Apartment, suite, unit, building, floor, etc." %>
        </div>

        <!-- City, State, ZIP -->
        <div class="col-12 col-md-5">
          <%= form.label :city, class: "form-label fw-bold" %>
          <%= form.text_field :city, class: "form-control", placeholder: "City" %>
        </div>

        <div class="col-12 col-md-3">
          <%= form.label :state, class: "form-label fw-bold" %>
          <%= form.text_field :state, class: "form-control", placeholder: "State" %>
        </div>

        <div class="col-12 col-md-4">
          <%= form.label :zipcode, "ZIP Code", class: "form-label fw-bold" %>
          <%= form.text_field :zipcode, class: "form-control", placeholder: "12345" %>
        </div>
      </div>
    </div>
  </div>

  <!-- Form Actions -->
  <div class="row">
    <div class="col-12">
      <div class="d-flex flex-column flex-sm-row gap-3 justify-content-end">
        <%= link_to "Cancel", event.persisted? ? event : events_path,
            class: "btn btn-outline-secondary order-2 order-sm-1" %>
        <%= form.submit event.persisted? ? "Update Event" : "Create Event",
            class: "btn btn-primary order-1 order-sm-2" %>
      </div>
    </div>
  </div>
<% end %>

<!-- Custom CSS -->
<style>
  .btn-primary {
    background-color: #0084FF;
    border-color: #0084FF;
  }
  .btn-primary:hover {
    background-color: #0066CC;
    border-color: #0066CC;
  }
  .form-check-input:checked {
    background-color: #0084FF;
    border-color: #0084FF;
  }
  .form-control:focus, .form-select:focus {
    border-color: #80bdff;
    box-shadow: 0 0 0 0.2rem rgba(0, 132, 255, 0.25);
  }
</style>

<!-- Form Validation Script -->
<script>
  // Bootstrap form validation
  (function() {
    'use strict';
    window.addEventListener('load', function() {
      var forms = document.getElementsByClassName('needs-validation');
      var validation = Array.prototype.filter.call(forms, function(form) {
        form.addEventListener('submit', function(event) {
          if (form.checkValidity() === false) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    }, false);
  })();
</script>
